<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<style type="text/css">
pre { white-space: pre-wrap; }
.ef0,.f0 { color: #000000; } .eb0,.b0 { background-color: #000000; }
.ef1,.f1 { color: #AA0000; } .eb1,.b1 { background-color: #AA0000; }
.ef2,.f2 { color: #00AA00; } .eb2,.b2 { background-color: #00AA00; }
.ef3,.f3 { color: #AA5500; } .eb3,.b3 { background-color: #AA5500; }
.ef4,.f4 { color: #0000AA; } .eb4,.b4 { background-color: #0000AA; }
.ef5,.f5 { color: #AA00AA; } .eb5,.b5 { background-color: #AA00AA; }
.ef6,.f6 { color: #00AAAA; } .eb6,.b6 { background-color: #00AAAA; }
.ef7,.f7 { color: #AAAAAA; } .eb7,.b7 { background-color: #AAAAAA; }
.ef8, .f0 > .bold,.bold > .f0 { color: #555555; font-weight: normal; }
.ef9, .f1 > .bold,.bold > .f1 { color: #FF5555; font-weight: normal; }
.ef10,.f2 > .bold,.bold > .f2 { color: #55FF55; font-weight: normal; }
.ef11,.f3 > .bold,.bold > .f3 { color: #FFFF55; font-weight: normal; }
.ef12,.f4 > .bold,.bold > .f4 { color: #5555FF; font-weight: normal; }
.ef13,.f5 > .bold,.bold > .f5 { color: #FF55FF; font-weight: normal; }
.ef14,.f6 > .bold,.bold > .f6 { color: #55FFFF; font-weight: normal; }
.ef15,.f7 > .bold,.bold > .f7 { color: #FFFFFF; font-weight: normal; }
.eb8  { background-color: #555555; }
.eb9  { background-color: #FF5555; }
.eb10 { background-color: #55FF55; }
.eb11 { background-color: #FFFF55; }
.eb12 { background-color: #5555FF; }
.eb13 { background-color: #FF55FF; }
.eb14 { background-color: #55FFFF; }
.eb15 { background-color: #FFFFFF; }
.ef16 { color: #000000; } .eb16 { background-color: #000000; }
.ef17 { color: #00005f; } .eb17 { background-color: #00005f; }
.ef18 { color: #000087; } .eb18 { background-color: #000087; }
.ef19 { color: #0000af; } .eb19 { background-color: #0000af; }
.ef20 { color: #0000d7; } .eb20 { background-color: #0000d7; }
.ef21 { color: #0000ff; } .eb21 { background-color: #0000ff; }
.ef22 { color: #005f00; } .eb22 { background-color: #005f00; }
.ef23 { color: #005f5f; } .eb23 { background-color: #005f5f; }
.ef24 { color: #005f87; } .eb24 { background-color: #005f87; }
.ef25 { color: #005faf; } .eb25 { background-color: #005faf; }
.ef26 { color: #005fd7; } .eb26 { background-color: #005fd7; }
.ef27 { color: #005fff; } .eb27 { background-color: #005fff; }
.ef28 { color: #008700; } .eb28 { background-color: #008700; }
.ef29 { color: #00875f; } .eb29 { background-color: #00875f; }
.ef30 { color: #008787; } .eb30 { background-color: #008787; }
.ef31 { color: #0087af; } .eb31 { background-color: #0087af; }
.ef32 { color: #0087d7; } .eb32 { background-color: #0087d7; }
.ef33 { color: #0087ff; } .eb33 { background-color: #0087ff; }
.ef34 { color: #00af00; } .eb34 { background-color: #00af00; }
.ef35 { color: #00af5f; } .eb35 { background-color: #00af5f; }
.ef36 { color: #00af87; } .eb36 { background-color: #00af87; }
.ef37 { color: #00afaf; } .eb37 { background-color: #00afaf; }
.ef38 { color: #00afd7; } .eb38 { background-color: #00afd7; }
.ef39 { color: #00afff; } .eb39 { background-color: #00afff; }
.ef40 { color: #00d700; } .eb40 { background-color: #00d700; }
.ef41 { color: #00d75f; } .eb41 { background-color: #00d75f; }
.ef42 { color: #00d787; } .eb42 { background-color: #00d787; }
.ef43 { color: #00d7af; } .eb43 { background-color: #00d7af; }
.ef44 { color: #00d7d7; } .eb44 { background-color: #00d7d7; }
.ef45 { color: #00d7ff; } .eb45 { background-color: #00d7ff; }
.ef46 { color: #00ff00; } .eb46 { background-color: #00ff00; }
.ef47 { color: #00ff5f; } .eb47 { background-color: #00ff5f; }
.ef48 { color: #00ff87; } .eb48 { background-color: #00ff87; }
.ef49 { color: #00ffaf; } .eb49 { background-color: #00ffaf; }
.ef50 { color: #00ffd7; } .eb50 { background-color: #00ffd7; }
.ef51 { color: #00ffff; } .eb51 { background-color: #00ffff; }
.ef52 { color: #5f0000; } .eb52 { background-color: #5f0000; }
.ef53 { color: #5f005f; } .eb53 { background-color: #5f005f; }
.ef54 { color: #5f0087; } .eb54 { background-color: #5f0087; }
.ef55 { color: #5f00af; } .eb55 { background-color: #5f00af; }
.ef56 { color: #5f00d7; } .eb56 { background-color: #5f00d7; }
.ef57 { color: #5f00ff; } .eb57 { background-color: #5f00ff; }
.ef58 { color: #5f5f00; } .eb58 { background-color: #5f5f00; }
.ef59 { color: #5f5f5f; } .eb59 { background-color: #5f5f5f; }
.ef60 { color: #5f5f87; } .eb60 { background-color: #5f5f87; }
.ef61 { color: #5f5faf; } .eb61 { background-color: #5f5faf; }
.ef62 { color: #5f5fd7; } .eb62 { background-color: #5f5fd7; }
.ef63 { color: #5f5fff; } .eb63 { background-color: #5f5fff; }
.ef64 { color: #5f8700; } .eb64 { background-color: #5f8700; }
.ef65 { color: #5f875f; } .eb65 { background-color: #5f875f; }
.ef66 { color: #5f8787; } .eb66 { background-color: #5f8787; }
.ef67 { color: #5f87af; } .eb67 { background-color: #5f87af; }
.ef68 { color: #5f87d7; } .eb68 { background-color: #5f87d7; }
.ef69 { color: #5f87ff; } .eb69 { background-color: #5f87ff; }
.ef70 { color: #5faf00; } .eb70 { background-color: #5faf00; }
.ef71 { color: #5faf5f; } .eb71 { background-color: #5faf5f; }
.ef72 { color: #5faf87; } .eb72 { background-color: #5faf87; }
.ef73 { color: #5fafaf; } .eb73 { background-color: #5fafaf; }
.ef74 { color: #5fafd7; } .eb74 { background-color: #5fafd7; }
.ef75 { color: #5fafff; } .eb75 { background-color: #5fafff; }
.ef76 { color: #5fd700; } .eb76 { background-color: #5fd700; }
.ef77 { color: #5fd75f; } .eb77 { background-color: #5fd75f; }
.ef78 { color: #5fd787; } .eb78 { background-color: #5fd787; }
.ef79 { color: #5fd7af; } .eb79 { background-color: #5fd7af; }
.ef80 { color: #5fd7d7; } .eb80 { background-color: #5fd7d7; }
.ef81 { color: #5fd7ff; } .eb81 { background-color: #5fd7ff; }
.ef82 { color: #5fff00; } .eb82 { background-color: #5fff00; }
.ef83 { color: #5fff5f; } .eb83 { background-color: #5fff5f; }
.ef84 { color: #5fff87; } .eb84 { background-color: #5fff87; }
.ef85 { color: #5fffaf; } .eb85 { background-color: #5fffaf; }
.ef86 { color: #5fffd7; } .eb86 { background-color: #5fffd7; }
.ef87 { color: #5fffff; } .eb87 { background-color: #5fffff; }
.ef88 { color: #870000; } .eb88 { background-color: #870000; }
.ef89 { color: #87005f; } .eb89 { background-color: #87005f; }
.ef90 { color: #870087; } .eb90 { background-color: #870087; }
.ef91 { color: #8700af; } .eb91 { background-color: #8700af; }
.ef92 { color: #8700d7; } .eb92 { background-color: #8700d7; }
.ef93 { color: #8700ff; } .eb93 { background-color: #8700ff; }
.ef94 { color: #875f00; } .eb94 { background-color: #875f00; }
.ef95 { color: #875f5f; } .eb95 { background-color: #875f5f; }
.ef96 { color: #875f87; } .eb96 { background-color: #875f87; }
.ef97 { color: #875faf; } .eb97 { background-color: #875faf; }
.ef98 { color: #875fd7; } .eb98 { background-color: #875fd7; }
.ef99 { color: #875fff; } .eb99 { background-color: #875fff; }
.ef100 { color: #878700; } .eb100 { background-color: #878700; }
.ef101 { color: #87875f; } .eb101 { background-color: #87875f; }
.ef102 { color: #878787; } .eb102 { background-color: #878787; }
.ef103 { color: #8787af; } .eb103 { background-color: #8787af; }
.ef104 { color: #8787d7; } .eb104 { background-color: #8787d7; }
.ef105 { color: #8787ff; } .eb105 { background-color: #8787ff; }
.ef106 { color: #87af00; } .eb106 { background-color: #87af00; }
.ef107 { color: #87af5f; } .eb107 { background-color: #87af5f; }
.ef108 { color: #87af87; } .eb108 { background-color: #87af87; }
.ef109 { color: #87afaf; } .eb109 { background-color: #87afaf; }
.ef110 { color: #87afd7; } .eb110 { background-color: #87afd7; }
.ef111 { color: #87afff; } .eb111 { background-color: #87afff; }
.ef112 { color: #87d700; } .eb112 { background-color: #87d700; }
.ef113 { color: #87d75f; } .eb113 { background-color: #87d75f; }
.ef114 { color: #87d787; } .eb114 { background-color: #87d787; }
.ef115 { color: #87d7af; } .eb115 { background-color: #87d7af; }
.ef116 { color: #87d7d7; } .eb116 { background-color: #87d7d7; }
.ef117 { color: #87d7ff; } .eb117 { background-color: #87d7ff; }
.ef118 { color: #87ff00; } .eb118 { background-color: #87ff00; }
.ef119 { color: #87ff5f; } .eb119 { background-color: #87ff5f; }
.ef120 { color: #87ff87; } .eb120 { background-color: #87ff87; }
.ef121 { color: #87ffaf; } .eb121 { background-color: #87ffaf; }
.ef122 { color: #87ffd7; } .eb122 { background-color: #87ffd7; }
.ef123 { color: #87ffff; } .eb123 { background-color: #87ffff; }
.ef124 { color: #af0000; } .eb124 { background-color: #af0000; }
.ef125 { color: #af005f; } .eb125 { background-color: #af005f; }
.ef126 { color: #af0087; } .eb126 { background-color: #af0087; }
.ef127 { color: #af00af; } .eb127 { background-color: #af00af; }
.ef128 { color: #af00d7; } .eb128 { background-color: #af00d7; }
.ef129 { color: #af00ff; } .eb129 { background-color: #af00ff; }
.ef130 { color: #af5f00; } .eb130 { background-color: #af5f00; }
.ef131 { color: #af5f5f; } .eb131 { background-color: #af5f5f; }
.ef132 { color: #af5f87; } .eb132 { background-color: #af5f87; }
.ef133 { color: #af5faf; } .eb133 { background-color: #af5faf; }
.ef134 { color: #af5fd7; } .eb134 { background-color: #af5fd7; }
.ef135 { color: #af5fff; } .eb135 { background-color: #af5fff; }
.ef136 { color: #af8700; } .eb136 { background-color: #af8700; }
.ef137 { color: #af875f; } .eb137 { background-color: #af875f; }
.ef138 { color: #af8787; } .eb138 { background-color: #af8787; }
.ef139 { color: #af87af; } .eb139 { background-color: #af87af; }
.ef140 { color: #af87d7; } .eb140 { background-color: #af87d7; }
.ef141 { color: #af87ff; } .eb141 { background-color: #af87ff; }
.ef142 { color: #afaf00; } .eb142 { background-color: #afaf00; }
.ef143 { color: #afaf5f; } .eb143 { background-color: #afaf5f; }
.ef144 { color: #afaf87; } .eb144 { background-color: #afaf87; }
.ef145 { color: #afafaf; } .eb145 { background-color: #afafaf; }
.ef146 { color: #afafd7; } .eb146 { background-color: #afafd7; }
.ef147 { color: #afafff; } .eb147 { background-color: #afafff; }
.ef148 { color: #afd700; } .eb148 { background-color: #afd700; }
.ef149 { color: #afd75f; } .eb149 { background-color: #afd75f; }
.ef150 { color: #afd787; } .eb150 { background-color: #afd787; }
.ef151 { color: #afd7af; } .eb151 { background-color: #afd7af; }
.ef152 { color: #afd7d7; } .eb152 { background-color: #afd7d7; }
.ef153 { color: #afd7ff; } .eb153 { background-color: #afd7ff; }
.ef154 { color: #afff00; } .eb154 { background-color: #afff00; }
.ef155 { color: #afff5f; } .eb155 { background-color: #afff5f; }
.ef156 { color: #afff87; } .eb156 { background-color: #afff87; }
.ef157 { color: #afffaf; } .eb157 { background-color: #afffaf; }
.ef158 { color: #afffd7; } .eb158 { background-color: #afffd7; }
.ef159 { color: #afffff; } .eb159 { background-color: #afffff; }
.ef160 { color: #d70000; } .eb160 { background-color: #d70000; }
.ef161 { color: #d7005f; } .eb161 { background-color: #d7005f; }
.ef162 { color: #d70087; } .eb162 { background-color: #d70087; }
.ef163 { color: #d700af; } .eb163 { background-color: #d700af; }
.ef164 { color: #d700d7; } .eb164 { background-color: #d700d7; }
.ef165 { color: #d700ff; } .eb165 { background-color: #d700ff; }
.ef166 { color: #d75f00; } .eb166 { background-color: #d75f00; }
.ef167 { color: #d75f5f; } .eb167 { background-color: #d75f5f; }
.ef168 { color: #d75f87; } .eb168 { background-color: #d75f87; }
.ef169 { color: #d75faf; } .eb169 { background-color: #d75faf; }
.ef170 { color: #d75fd7; } .eb170 { background-color: #d75fd7; }
.ef171 { color: #d75fff; } .eb171 { background-color: #d75fff; }
.ef172 { color: #d78700; } .eb172 { background-color: #d78700; }
.ef173 { color: #d7875f; } .eb173 { background-color: #d7875f; }
.ef174 { color: #d78787; } .eb174 { background-color: #d78787; }
.ef175 { color: #d787af; } .eb175 { background-color: #d787af; }
.ef176 { color: #d787d7; } .eb176 { background-color: #d787d7; }
.ef177 { color: #d787ff; } .eb177 { background-color: #d787ff; }
.ef178 { color: #d7af00; } .eb178 { background-color: #d7af00; }
.ef179 { color: #d7af5f; } .eb179 { background-color: #d7af5f; }
.ef180 { color: #d7af87; } .eb180 { background-color: #d7af87; }
.ef181 { color: #d7afaf; } .eb181 { background-color: #d7afaf; }
.ef182 { color: #d7afd7; } .eb182 { background-color: #d7afd7; }
.ef183 { color: #d7afff; } .eb183 { background-color: #d7afff; }
.ef184 { color: #d7d700; } .eb184 { background-color: #d7d700; }
.ef185 { color: #d7d75f; } .eb185 { background-color: #d7d75f; }
.ef186 { color: #d7d787; } .eb186 { background-color: #d7d787; }
.ef187 { color: #d7d7af; } .eb187 { background-color: #d7d7af; }
.ef188 { color: #d7d7d7; } .eb188 { background-color: #d7d7d7; }
.ef189 { color: #d7d7ff; } .eb189 { background-color: #d7d7ff; }
.ef190 { color: #d7ff00; } .eb190 { background-color: #d7ff00; }
.ef191 { color: #d7ff5f; } .eb191 { background-color: #d7ff5f; }
.ef192 { color: #d7ff87; } .eb192 { background-color: #d7ff87; }
.ef193 { color: #d7ffaf; } .eb193 { background-color: #d7ffaf; }
.ef194 { color: #d7ffd7; } .eb194 { background-color: #d7ffd7; }
.ef195 { color: #d7ffff; } .eb195 { background-color: #d7ffff; }
.ef196 { color: #ff0000; } .eb196 { background-color: #ff0000; }
.ef197 { color: #ff005f; } .eb197 { background-color: #ff005f; }
.ef198 { color: #ff0087; } .eb198 { background-color: #ff0087; }
.ef199 { color: #ff00af; } .eb199 { background-color: #ff00af; }
.ef200 { color: #ff00d7; } .eb200 { background-color: #ff00d7; }
.ef201 { color: #ff00ff; } .eb201 { background-color: #ff00ff; }
.ef202 { color: #ff5f00; } .eb202 { background-color: #ff5f00; }
.ef203 { color: #ff5f5f; } .eb203 { background-color: #ff5f5f; }
.ef204 { color: #ff5f87; } .eb204 { background-color: #ff5f87; }
.ef205 { color: #ff5faf; } .eb205 { background-color: #ff5faf; }
.ef206 { color: #ff5fd7; } .eb206 { background-color: #ff5fd7; }
.ef207 { color: #ff5fff; } .eb207 { background-color: #ff5fff; }
.ef208 { color: #ff8700; } .eb208 { background-color: #ff8700; }
.ef209 { color: #ff875f; } .eb209 { background-color: #ff875f; }
.ef210 { color: #ff8787; } .eb210 { background-color: #ff8787; }
.ef211 { color: #ff87af; } .eb211 { background-color: #ff87af; }
.ef212 { color: #ff87d7; } .eb212 { background-color: #ff87d7; }
.ef213 { color: #ff87ff; } .eb213 { background-color: #ff87ff; }
.ef214 { color: #ffaf00; } .eb214 { background-color: #ffaf00; }
.ef215 { color: #ffaf5f; } .eb215 { background-color: #ffaf5f; }
.ef216 { color: #ffaf87; } .eb216 { background-color: #ffaf87; }
.ef217 { color: #ffafaf; } .eb217 { background-color: #ffafaf; }
.ef218 { color: #ffafd7; } .eb218 { background-color: #ffafd7; }
.ef219 { color: #ffafff; } .eb219 { background-color: #ffafff; }
.ef220 { color: #ffd700; } .eb220 { background-color: #ffd700; }
.ef221 { color: #ffd75f; } .eb221 { background-color: #ffd75f; }
.ef222 { color: #ffd787; } .eb222 { background-color: #ffd787; }
.ef223 { color: #ffd7af; } .eb223 { background-color: #ffd7af; }
.ef224 { color: #ffd7d7; } .eb224 { background-color: #ffd7d7; }
.ef225 { color: #ffd7ff; } .eb225 { background-color: #ffd7ff; }
.ef226 { color: #ffff00; } .eb226 { background-color: #ffff00; }
.ef227 { color: #ffff5f; } .eb227 { background-color: #ffff5f; }
.ef228 { color: #ffff87; } .eb228 { background-color: #ffff87; }
.ef229 { color: #ffffaf; } .eb229 { background-color: #ffffaf; }
.ef230 { color: #ffffd7; } .eb230 { background-color: #ffffd7; }
.ef231 { color: #ffffff; } .eb231 { background-color: #ffffff; }
.ef232 { color: #080808; } .eb232 { background-color: #080808; }
.ef233 { color: #121212; } .eb233 { background-color: #121212; }
.ef234 { color: #1c1c1c; } .eb234 { background-color: #1c1c1c; }
.ef235 { color: #262626; } .eb235 { background-color: #262626; }
.ef236 { color: #303030; } .eb236 { background-color: #303030; }
.ef237 { color: #3a3a3a; } .eb237 { background-color: #3a3a3a; }
.ef238 { color: #444444; } .eb238 { background-color: #444444; }
.ef239 { color: #4e4e4e; } .eb239 { background-color: #4e4e4e; }
.ef240 { color: #585858; } .eb240 { background-color: #585858; }
.ef241 { color: #626262; } .eb241 { background-color: #626262; }
.ef242 { color: #6c6c6c; } .eb242 { background-color: #6c6c6c; }
.ef243 { color: #767676; } .eb243 { background-color: #767676; }
.ef244 { color: #808080; } .eb244 { background-color: #808080; }
.ef245 { color: #8a8a8a; } .eb245 { background-color: #8a8a8a; }
.ef246 { color: #949494; } .eb246 { background-color: #949494; }
.ef247 { color: #9e9e9e; } .eb247 { background-color: #9e9e9e; }
.ef248 { color: #a8a8a8; } .eb248 { background-color: #a8a8a8; }
.ef249 { color: #b2b2b2; } .eb249 { background-color: #b2b2b2; }
.ef250 { color: #bcbcbc; } .eb250 { background-color: #bcbcbc; }
.ef251 { color: #c6c6c6; } .eb251 { background-color: #c6c6c6; }
.ef252 { color: #d0d0d0; } .eb252 { background-color: #d0d0d0; }
.ef253 { color: #dadada; } .eb253 { background-color: #dadada; }
.ef254 { color: #e4e4e4; } .eb254 { background-color: #e4e4e4; }
.ef255 { color: #eeeeee; } .eb255 { background-color: #eeeeee; }

.f9 { color: #000000; }
.b9 { background-color: #FFFFFF; }
.f9 > .bold,.bold > .f9, body.f9 > pre > .bold {
  /* Bold is heavy black on white, or bright white
     depending on the default background */
  color: #000000;
  font-weight: bold;
}
.reverse {
  /* CSS does not support swapping fg and bg colours unfortunately,
     so just hardcode something that will look OK on all backgrounds. */
  color: #000000; background-color: #AAAAAA;
}
.underline { text-decoration: underline; }
.line-through { text-decoration: line-through; }
.blink { text-decoration: blink; }

/* Avoid pixels between adjacent span elements.
   Note this only works for lines less than 80 chars
   where we close span elements on the same line.
span { display: inline-block; }
*/
</style>
</head>

<body class="f9 b9">
<pre>
<span class="bold">diff --git a/mixing/dcnet.go b/mixing/dcnet.go</span>
<span class="bold">index 3091d711..30342206 100644</span>
<span class="bold">--- a/mixing/dcnet.go</span>
<span class="bold">+++ b/mixing/dcnet.go</span>
<span class="f6">@@ -8,8 +8,8 @@</span> import (
 	&quot;encoding/binary&quot;
 	&quot;math/big&quot;
 
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 	&quot;github.com/decred/dcrd/crypto/blake256&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
 )
 
 // SRMixPads creates a vector of exponential DC-net pads from a vector of
<span class="bold">diff --git a/mixing/expiry.go b/mixing/expiry.go</span>
<span class="bold">index f2d6c7d2..49349827 100644</span>
<span class="bold">--- a/mixing/expiry.go</span>
<span class="bold">+++ b/mixing/expiry.go</span>
<span class="f6">@@ -7,7 +7,7 @@</span> package mixing
 import (
 	&quot;time&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/v3&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg&quot;</span>
 )
 
 // MaxExpiry returns the maximum allowed expiry for a new pair request message
<span class="bold">diff --git a/mixing/go.mod b/mixing/go.mod</span>
<span class="bold">deleted file mode 100644</span>
<span class="bold">index b9e7a55d..00000000</span>
<span class="bold">--- a/mixing/go.mod</span>
<span class="bold">+++ /dev/null</span>
<span class="f6">@@ -1,33 +0,0 @@</span>
<span class="f1">-module github.com/decred/dcrd/mixing</span>
<span class="f1">-</span>
<span class="f1">-go 1.18</span>
<span class="f1">-</span>
<span class="f1">-require (</span>
<span class="f1">-	decred.org/cspp/v2 v2.4.0</span>
<span class="f1">-	github.com/companyzero/sntrup4591761 v0.0.0-20220309191932-9e0f3af2f07a</span>
<span class="f1">-	github.com/davecgh/go-spew v1.1.1</span>
<span class="f1">-	github.com/decred/dcrd/chaincfg/chainhash v1.0.4</span>
<span class="f1">-	github.com/decred/dcrd/chaincfg/v3 v3.2.1</span>
<span class="f1">-	github.com/decred/dcrd/container/lru v1.0.0</span>
<span class="f1">-	github.com/decred/dcrd/crypto/blake256 v1.1.0</span>
<span class="f1">-	github.com/decred/dcrd/crypto/rand v1.0.1</span>
<span class="f1">-	github.com/decred/dcrd/dcrec v1.0.1</span>
<span class="f1">-	github.com/decred/dcrd/dcrec/secp256k1/v4 v4.3.0</span>
<span class="f1">-	github.com/decred/dcrd/dcrutil/v4 v4.0.2</span>
<span class="f1">-	github.com/decred/dcrd/txscript/v4 v4.1.1</span>
<span class="f1">-	github.com/decred/dcrd/wire v1.7.0</span>
<span class="f1">-	github.com/decred/slog v1.2.0</span>
<span class="f1">-	golang.org/x/crypto v0.33.0</span>
<span class="f1">-	golang.org/x/sync v0.11.0</span>
<span class="f1">-)</span>
<span class="f1">-</span>
<span class="f1">-require (</span>
<span class="f1">-	github.com/agl/ed25519 v0.0.0-20170116200512-5312a6153412 // indirect</span>
<span class="f1">-	github.com/dchest/siphash v1.2.3 // indirect</span>
<span class="f1">-	github.com/decred/base58 v1.0.5 // indirect</span>
<span class="f1">-	github.com/decred/dcrd/crypto/ripemd160 v1.0.2 // indirect</span>
<span class="f1">-	github.com/decred/dcrd/dcrec/edwards/v2 v2.0.3 // indirect</span>
<span class="f1">-	github.com/klauspost/cpuid/v2 v2.0.9 // indirect</span>
<span class="f1">-	golang.org/x/sys v0.30.0 // indirect</span>
<span class="f1">-	lukechampine.com/blake3 v1.3.0 // indirect</span>
<span class="f1">-)</span>
<span class="bold">diff --git a/mixing/go.sum b/mixing/go.sum</span>
<span class="bold">deleted file mode 100644</span>
<span class="bold">index 34150b92..00000000</span>
<span class="bold">--- a/mixing/go.sum</span>
<span class="bold">+++ /dev/null</span>
<span class="f6">@@ -1,48 +0,0 @@</span>
<span class="f1">-decred.org/cspp/v2 v2.4.0 h1:whb0YW+UELHJS/UfT5MBXSJXrKUVw5omhgKNhjzYix4=</span>
<span class="f1">-decred.org/cspp/v2 v2.4.0/go.mod h1:9nO3bfvCheOPIFZw5f6sRQ42CjBFB5RKSaJ9Iq6G4MA=
-github.com/agl/ed25519 v0.0.0-20170116200512-5312a6153412 h1:w1UutsfOrms1J05zt7ISrnJIXKzwaspym5BTKGx93EI=
-github.com/agl/ed25519 v0.0.0-20170116200512-5312a6153412/go.mod h1:WPjqKcmVOxf0XSf3YxCJs6N6AOSrOx3obionmG7T0y0=
-github.com/companyzero/sntrup4591761 v0.0.0-20220309191932-9e0f3af2f07a h1:clYxJ3Os0EQUKDDVU8M0oipllX0EkuFNBfhVQuIfyF0=
-github.com/companyzero/sntrup4591761 v0.0.0-20220309191932-9e0f3af2f07a/go.mod h1:z/9Ck1EDixEbBbZ2KH2qNHekEmDLTOZ+FyoIPWWSVOI=
-github.com/davecgh/go-spew v1.1.1 h1:vj9j/u1bqnvCEfJOwUhtlOARqs3+rkHYY13jYWTU97c=</span>
<span class="f1">-github.com/davecgh/go-spew v1.1.1/go.mod h1:J7Y8YcW2NihsgmVo/mv3lAwl/skON4iLHjSsI+c5H38=</span>
<span class="f1">-github.com/dchest/siphash v1.2.3 h1:QXwFc8cFOR2dSa/gE6o/HokBMWtLUaNDVd+22aKHeEA=</span>
<span class="f1">-github.com/dchest/siphash v1.2.3/go.mod h1:0NvQU092bT0ipiFN++/rXm69QG9tVxLAlQHIXMPAkHc=</span>
<span class="f1">-github.com/decred/base58 v1.0.5 h1:hwcieUM3pfPnE/6p3J100zoRfGkQxBulZHo7GZfOqic=</span>
<span class="f1">-github.com/decred/base58 v1.0.5/go.mod h1:s/8lukEHFA6bUQQb/v3rjUySJ2hu+RioCzLukAVkrfw=</span>
<span class="f1">-github.com/decred/dcrd/chaincfg/chainhash v1.0.4 h1:zRCv6tdncLfLTKYqu7hrXvs7hW+8FO/NvwoFvGsrluU=</span>
<span class="f1">-github.com/decred/dcrd/chaincfg/chainhash v1.0.4/go.mod h1:hA86XxlBWwHivMvxzXTSD0ZCG/LoYsFdWnCekkTMCqY=</span>
<span class="f1">-github.com/decred/dcrd/chaincfg/v3 v3.2.1 h1:x9zKJaU24WAKbxAR1UyFKHlM3oJgP0H9LodokM4X5lM=</span>
<span class="f1">-github.com/decred/dcrd/chaincfg/v3 v3.2.1/go.mod h1:SDCWDtY7BLj0leXc9FuoA1YjSVKyCIBVAyxwZn6+sXc=</span>
<span class="f1">-github.com/decred/dcrd/container/lru v1.0.0 h1:7foQymtbu18aQWYiY9RnNIeE+kvpiN+fiBQ3+viyJjI=</span>
<span class="f1">-github.com/decred/dcrd/container/lru v1.0.0/go.mod h1:vlPwj0l+IzAHhQSsbgQnJgO5Cte78+yI065V+Mc5PRQ=</span>
<span class="f1">-github.com/decred/dcrd/crypto/blake256 v1.1.0 h1:zPMNGQCm0g4QTY27fOCorQW7EryeQ/U0x++OzVrdms8=</span>
<span class="f1">-github.com/decred/dcrd/crypto/blake256 v1.1.0/go.mod h1:2OfgNZ5wDpcsFmHmCK5gZTPcCXqlm2ArzUIkw9czNJo=</span>
<span class="f1">-github.com/decred/dcrd/crypto/rand v1.0.1 h1:pYMgDRmRv1z1RNgAAs8izJstm4B+fLFiqGD5btOt2Wg=</span>
<span class="f1">-github.com/decred/dcrd/crypto/rand v1.0.1/go.mod h1:MsA2XySk/4KpCOYW6vsNYTGuOYRK1wpvulaWCuW7RyI=</span>
<span class="f1">-github.com/decred/dcrd/crypto/ripemd160 v1.0.2 h1:TvGTmUBHDU75OHro9ojPLK+Yv7gDl2hnUvRocRCjsys=</span>
<span class="f1">-github.com/decred/dcrd/crypto/ripemd160 v1.0.2/go.mod h1:uGfjDyePSpa75cSQLzNdVmWlbQMBuiJkvXw/MNKRY4M=</span>
<span class="f1">-github.com/decred/dcrd/dcrec v1.0.1 h1:gDzlndw0zYxM5BlaV17d7ZJV6vhRe9njPBFeg4Db2UY=</span>
<span class="f1">-github.com/decred/dcrd/dcrec v1.0.1/go.mod h1:CO+EJd8eHFb8WHa84C7ZBkXsNUIywaTHb+UAuI5uo6o=</span>
<span class="f1">-github.com/decred/dcrd/dcrec/edwards/v2 v2.0.3 h1:l/lhv2aJCUignzls81+wvga0TFlyoZx8QxRMQgXpZik=</span>
<span class="f1">-github.com/decred/dcrd/dcrec/edwards/v2 v2.0.3/go.mod h1:AKpV6+wZ2MfPRJnTbQ6NPgWrKzbe9RCIlCF/FKzMtM8=</span>
<span class="f1">-github.com/decred/dcrd/dcrec/secp256k1/v4 v4.3.0 h1:rpfIENRNNilwHwZeG5+P150SMrnNEcHYvcCuK6dPZSg=</span>
<span class="f1">-github.com/decred/dcrd/dcrec/secp256k1/v4 v4.3.0/go.mod h1:v57UDF4pDQJcEfFUCRop3lJL149eHGSe9Jvczhzjo/0=</span>
<span class="f1">-github.com/decred/dcrd/dcrutil/v4 v4.0.2 h1:eIl3E6gGln54qE8nk5o5lLtjh2/9C2Rz63OpD662h+8=</span>
<span class="f1">-github.com/decred/dcrd/dcrutil/v4 v4.0.2/go.mod h1:iS3JB1ac3R3FgfpTF1kBD+SPNet8TmiW3Br+/Jc5MC8=</span>
<span class="f1">-github.com/decred/dcrd/txscript/v4 v4.1.1 h1:R4M2+jMujgQA91899SkL0cW66d6DC76Gx+1W1oEHjc0=</span>
<span class="f1">-github.com/decred/dcrd/txscript/v4 v4.1.1/go.mod h1:7ybmJoI+b6dxvQ+0aXdZpkyrj0PbnylJCzFxD1g8+/A=</span>
<span class="f1">-github.com/decred/dcrd/wire v1.7.0 h1:5JHiDjEQeS4XUl4PfnTZYLwAD/E/+LwBmPRec/fP76o=</span>
<span class="f1">-github.com/decred/dcrd/wire v1.7.0/go.mod h1:lAqrzV0SU4kyV6INLEJgDtUjJaTaVKrbF4LHtaYl+zU=</span>
<span class="f1">-github.com/decred/slog v1.2.0 h1:soHAxV52B54Di3WtKLfPum9OFfWqwtf/ygf9njdfnPM=</span>
<span class="f1">-github.com/decred/slog v1.2.0/go.mod h1:kVXlGnt6DHy2fV5OjSeuvCJ0OmlmTF6LFpEPMu/fOY0=</span>
<span class="f1">-github.com/klauspost/cpuid/v2 v2.0.9 h1:lgaqFMSdTdQYdZ04uHyN2d/eKdOMyi2YLSvlQIBFYa4=</span>
<span class="f1">-github.com/klauspost/cpuid/v2 v2.0.9/go.mod h1:FInQzS24/EEf25PyTYn52gqo7WaD8xa0213Md/qVLRg=</span>
<span class="f1">-golang.org/x/crypto v0.33.0 h1:IOBPskki6Lysi0lo9qQvbxiQ+FvsCC/YWOecCHAixus=</span>
<span class="f1">-golang.org/x/crypto v0.33.0/go.mod h1:bVdXmD7IV/4GdElGPozy6U7lWdRXA4qyRVGJV57uQ5M=</span>
<span class="f1">-golang.org/x/sync v0.11.0 h1:GGz8+XQP4FvTTrjZPzNKTMFtSXH80RAzG+5ghFPgK9w=</span>
<span class="f1">-golang.org/x/sync v0.11.0/go.mod h1:Czt+wKu1gCyEFDUtn0jG5QVvpJ6rzVqr5aXyt9drQfk=</span>
<span class="f1">-golang.org/x/sys v0.30.0 h1:QjkSwP/36a20jFYWkSue1YwXzLmsV5Gfq7Eiy72C1uc=</span>
<span class="f1">-golang.org/x/sys v0.30.0/go.mod h1:/VUhepiaJMQUp4+oa/7Zr1D23ma6VTLIYjOOTFZPUcA=</span>
<span class="f1">-lukechampine.com/blake3 v1.3.0 h1:sJ3XhFINmHSrYCgl958hscfIa3bw8x4DqMP3u1YvoYE=</span>
<span class="f1">-lukechampine.com/blake3 v1.3.0/go.mod h1:0OFRp7fBtAylGVCO40o87sbupkyIGgbpv1+M1k1LM6k=</span>
<span class="bold">diff --git a/mixing/keyagreement.go b/mixing/keyagreement.go</span>
<span class="bold">index daf96a0d..51e8f76d 100644</span>
<span class="bold">--- a/mixing/keyagreement.go</span>
<span class="bold">+++ b/mixing/keyagreement.go</span>
<span class="f6">@@ -14,8 +14,8 @@</span> import (
 	&quot;github.com/decred/dcrd/crypto/blake256&quot;
 	&quot;github.com/decred/dcrd/crypto/rand&quot;
 	&quot;github.com/decred/dcrd/dcrec/secp256k1/v4&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/mixing/internal/chacha20prng&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing/internal/chacha20prng&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 )
 
 // Aliases for sntrup4591761 types.
<span class="bold">diff --git a/mixing/message.go b/mixing/message.go</span>
<span class="bold">index 5dde451f..1622e14a 100644</span>
<span class="bold">--- a/mixing/message.go</span>
<span class="bold">+++ b/mixing/message.go</span>
<span class="f6">@@ -7,8 +7,8 @@</span> package mixing
 import (
 	&quot;hash&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 )
 
 // Message is a mixing message.  In addition to implementing wire encoding,
<span class="bold">diff --git a/mixing/mixclient/blame.go b/mixing/mixclient/blame.go</span>
<span class="bold">index 81c197cc..bc5d5751 100644</span>
<span class="bold">--- a/mixing/mixclient/blame.go</span>
<span class="bold">+++ b/mixing/mixclient/blame.go</span>
<span class="f6">@@ -13,12 +13,12 @@</span> import (
 	&quot;sort&quot;
 	&quot;time&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
 	&quot;github.com/decred/dcrd/dcrec/secp256k1/v4&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/mixing&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/mixing/internal/chacha20prng&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/mixing/mixpool&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing/internal/chacha20prng&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing/mixpool&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 )
 
 var errBlameFailed = errors.New(&quot;blame failed&quot;)
<span class="bold">diff --git a/mixing/mixclient/client.go b/mixing/mixclient/client.go</span>
<span class="bold">index 2921dba9..934185cd 100644</span>
<span class="bold">--- a/mixing/mixclient/client.go</span>
<span class="bold">+++ b/mixing/mixclient/client.go</span>
<span class="f6">@@ -20,17 +20,17 @@</span> import (
 	&quot;time&quot;
 
 	&quot;decred.org/cspp/v2/solverrpc&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/btcutil&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing/internal/chacha20prng&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing/mixpool&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/txscript&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btclog&quot;</span>
 	&quot;github.com/decred/dcrd/crypto/blake256&quot;
 	&quot;github.com/decred/dcrd/crypto/rand&quot;
 	&quot;github.com/decred/dcrd/dcrec/secp256k1/v4&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/mixing&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/mixing/internal/chacha20prng&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/mixing/mixpool&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/txscript/v4&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/txscript/v4/stdaddr&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
<span class="f1">-	&quot;github.com/decred/slog&quot;</span>
 	&quot;golang.org/x/sync/errgroup&quot;
 )
 
<span class="f6">@@ -308,7 +308,7 @@</span> type sessionRun struct {
 	// Finalized coinjoin of a successful run.
 	cj *CoinJoin
 
<span class="f1">-	logger slog.Logger</span>
<span class="f2">+</span>	<span class="f2">logger btclog.Logger</span>
 }
 
 func (s *sessionRun) logf(format string, args ...interface{}) {
<span class="f6">@@ -361,7 +361,7 @@</span> type Client struct {
 
 	stopping chan struct{}
 
<span class="f1">-	logger slog.Logger</span>
<span class="f2">+</span>	<span class="f2">logger btclog.Logger</span>
 
 	testTickC chan struct{}
 	testHooks map[hook]hookFunc
<span class="f6">@@ -390,7 +390,7 @@</span> func NewClient(w Wallet) *Client {
 	}
 }
 
<span class="f1">-func (c *Client) SetLogger(l slog.Logger) {</span>
<span class="f2">+func (c *Client) SetLogger(l btclog.Logger) {</span>
 	c.logger = l
 }
 
<span class="f6">@@ -999,7 +999,7 @@</span> func (c *Client) pairSession(ctx context.Context, ps *pairedSessions, prs []*wir
 			go func() {
 				time.Sleep(10 * time.Second)
 				mixedSession.logf(&quot;removing mixed session completed &quot;+
<span class="f1">-					&quot;with transaction %v&quot;, mixedSession.cj.txHash)</span>
<span class="f2">+</span>					<span class="f2">&quot;with transaction %v&quot;, mixedSession.cj.tx.TxHash())</span>
 				c.mixpool.RemoveSession(mixedSession.sid)
 			}()
 		}
<span class="f6">@@ -2064,19 +2064,19 @@</span> func (c *Client) validateMergedCoinjoin(cj *CoinJoin, prs []*wire.MsgMixPairReq,
 		24: txscript.OP_EQUALVERIFY,
 		25: txscript.OP_CHECKSIG,
 	}
<span class="f1">-	opcode := &amp;prevScript[0]</span>
<span class="f2">+</span>	<span class="f2">// opcode := &amp;prevScript[0]</span>
 	hash160 := prevScript[4:24]
 
 	prevScriptForUTXO := func(utxo *wire.MixPairReqUTXO) []byte {
 		switch utxo.Opcode {
 		case 0:
<span class="f1">-			copy(hash160, stdaddr.Hash160(utxo.PubKey))</span>
<span class="f2">+</span>			<span class="f2">copy(hash160, btcutil.Hash160(utxo.PubKey))</span>
 			return prevScript[1:]
 
<span class="f1">-		case txscript.OP_SSGEN, txscript.OP_SSRTX, txscript.OP_TGEN:</span>
<span class="f1">-			*opcode = utxo.Opcode</span>
<span class="f1">-			copy(hash160, stdaddr.Hash160(utxo.PubKey))</span>
<span class="f1">-			return prevScript</span>
<span class="f2">+</span>		<span class="f2">// case txscript.OP_SSGEN, txscript.OP_SSRTX, txscript.OP_TGEN:</span>
<span class="f2">+</span>		<span class="f2">// 	*opcode = utxo.Opcode</span>
<span class="f2">+</span>		<span class="f2">// 	copy(hash160, stdaddr.Hash160(utxo.PubKey))</span>
<span class="f2">+</span>		<span class="f2">// 	return prevScript</span>
 
 		default:
 			return nil
<span class="f6">@@ -2084,12 +2084,6 @@</span> func (c *Client) validateMergedCoinjoin(cj *CoinJoin, prs []*wire.MsgMixPairReq,
 	}
 
 	blamedInputs := make(map[wire.OutPoint]struct{})
<span class="f1">-	const scriptFlags = txscript.ScriptDiscourageUpgradableNops |</span>
<span class="f1">-		txscript.ScriptVerifyCleanStack |</span>
<span class="f1">-		txscript.ScriptVerifyCheckLockTimeVerify |</span>
<span class="f1">-		txscript.ScriptVerifyCheckSequenceVerify |</span>
<span class="f1">-		txscript.ScriptVerifyTreasury</span>
<span class="f1">-	const scriptVersion = 0</span>
 	for i, in := range cj.tx.TxIn {
 		utxo, ok := utxos[in.PreviousOutPoint]
 		if !ok {
<span class="f6">@@ -2101,7 +2095,7 @@</span> func (c *Client) validateMergedCoinjoin(cj *CoinJoin, prs []*wire.MsgMixPairReq,
 
 		pkscript := prevScriptForUTXO(utxo)
 		engine, err := txscript.NewEngine(pkscript, cj.tx, i,
<span class="f1">-			scriptFlags, scriptVersion, nil)</span>
<span class="f2">+</span>			<span class="f2">txscript.StandardVerifyFlags, nil, nil, 0, nil)</span>
 		if err != nil {
 			c.logf(&quot;warn: blaming peer for error creating script engine: %v&quot;, err)
 			blamedInputs[in.PreviousOutPoint] = struct{}{}
<span class="bold">diff --git a/mixing/mixclient/client_test.go b/mixing/mixclient/client_test.go</span>
<span class="bold">index 1f4d88d0..e569f6f9 100644</span>
<span class="bold">--- a/mixing/mixclient/client_test.go</span>
<span class="bold">+++ b/mixing/mixclient/client_test.go</span>
<span class="f6">@@ -13,17 +13,16 @@</span> import (
 	&quot;time&quot;
 
 	&quot;decred.org/cspp/v2/solverrpc&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/v3&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/dcrec&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/btcec/v2&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing/mixpool&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/txscript&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btclog&quot;</span>
 	&quot;github.com/decred/dcrd/dcrec/secp256k1/v4&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/mixing&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/mixing/mixpool&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/txscript/v4&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/txscript/v4/sign&quot;</span>
 	&quot;github.com/decred/dcrd/txscript/v4/stdaddr&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
<span class="f1">-	&quot;github.com/decred/slog&quot;</span>
 	&quot;golang.org/x/sync/errgroup&quot;
 )
 
<span class="f6">@@ -43,14 +42,14 @@</span> const (
 	mixValue   = 1 &lt;&lt; 20
 )
 
<span class="f1">-func newTestClient(w *testWallet, logger slog.Logger) *Client {</span>
<span class="f2">+func newTestClient(w *testWallet, logger btclog.Logger) *Client {</span>
 	c := NewClient(w)
 	c.testTickC = make(chan struct{})
 	c.SetLogger(logger)
 	return c
 }
 
<span class="f1">-var testnetParams = chaincfg.TestNet3Params()</span>
<span class="f2">+var testnetParams = chaincfg.TestNet3Params</span>
 
 type testBlockchain struct {
 	publishedTxs map[chainhash.Hash]*wire.MsgTx
<span class="f6">@@ -68,7 +67,7 @@</span> func (b *testBlockchain) CurrentTip() (chainhash.Hash, int64) {
 }
 
 func (b *testBlockchain) ChainParams() *chaincfg.Params {
<span class="f1">-	return testnetParams</span>
<span class="f2">+</span>	<span class="f2">return &amp;testnetParams</span>
 }
 
 type testWallet struct {
<span class="f6">@@ -104,8 +103,8 @@</span> func (w *testWallet) PublishTransaction(ctx context.Context, tx *wire.MsgTx) err
 }
 
 func (w *testWallet) SignInput(tx *wire.MsgTx, index int, prevScript []byte) error {
<span class="f1">-	sigScript, err := sign.SignatureScript(tx, index, prevScript, txscript.SigHashAll,</span>
<span class="f1">-		w.privForPkScript(prevScript).Serialize(), dcrec.STEcdsaSecp256k1, true)</span>
<span class="f2">+</span>	<span class="f2">sigScript, err := txscript.SignatureScript(tx, index, prevScript, txscript.SigHashAll,</span>
<span class="f2">+</span>		<span class="f2">w.privForPkScript(prevScript), true)</span>
 	if err != nil {
 		return err
 	}
<span class="f6">@@ -161,14 +160,14 @@</span> func (w *testWallet) outputScript() ([]byte, error) {
 	return pkScript, nil
 }
 
<span class="f1">-func (w *testWallet) privForHash160(hash160 [20]byte) *secp256k1.PrivateKey {</span>
<span class="f2">+func (w *testWallet) privForHash160(hash160 [20]byte) *btcec.PrivateKey {</span>
 	w.mu.Lock()
 	priv := w.keys[hash160]
 	w.mu.Unlock()
 	return priv
 }
 
<span class="f1">-func (w *testWallet) privForPkScript(p2pkhScript []byte) *secp256k1.PrivateKey {</span>
<span class="f2">+func (w *testWallet) privForPkScript(p2pkhScript []byte) *btcec.PrivateKey {</span>
 	hash160 := *(*[20]byte)(p2pkhScript[3:23])
 	return w.privForHash160(hash160)
 }
<span class="f6">@@ -187,12 +186,12 @@</span> func TestHonest(t *testing.T) {
 		cj *CoinJoin
 	}
 	peers := []*testPeer{
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 2)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 3)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 4)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 2)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 3)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 4)},</span>
 	}
<span class="f1">-	inputTx := wire.NewMsgTx()</span>
<span class="f2">+</span>	<span class="f2">inputTx := wire.NewMsgTx(wire.TxVersion)</span>
 	for range peers {
 		script, err := w.outputScript()
 		if err != nil {
<span class="f6">@@ -205,11 +204,11 @@</span> func TestHonest(t *testing.T) {
 		p := peers[i]
 
 		inputTxOutpoint.Index = uint32(i)
<span class="f1">-		input := wire.NewTxIn(&amp;inputTxOutpoint, inputTx.TxOut[i].Value, nil)</span>
<span class="f2">+</span>		<span class="f2">input := wire.NewTxIn(&amp;inputTxOutpoint, nil, nil)</span>
 
 		pkScript := inputTx.TxOut[i].PkScript
 
<span class="f1">-		p.cj.AddInput(input, pkScript, 0, w.privForPkScript(pkScript))</span>
<span class="f2">+</span>		<span class="f2">p.cj.AddInput(input, inputTx.TxOut[i].Value, pkScript, 0, w.privForPkScript(pkScript))</span>
 	}
 
 	ctx, cancel := context.WithCancel(context.Background())
<span class="f6">@@ -279,18 +278,18 @@</span> func testDisruption(t *testing.T, misbehavingID *identity, h hook, f hookFunc) {
 		cj *CoinJoin
 	}
 	peers := []*testPeer{
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f1">-		{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+10, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
<span class="f2">+</span>		<span class="f2">{cj: NewCoinJoin(w.gen, nil, mixValue, testStartingHeight+2, 1)},</span>
 	}
<span class="f1">-	inputTx := wire.NewMsgTx()</span>
<span class="f2">+</span>	<span class="f2">inputTx := wire.NewMsgTx(wire.TxVersion)</span>
 	for range peers {
 		script, err := w.outputScript()
 		if err != nil {
<span class="f6">@@ -303,11 +302,11 @@</span> func testDisruption(t *testing.T, misbehavingID *identity, h hook, f hookFunc) {
 		p := peers[i]
 
 		inputTxOutpoint.Index = uint32(i)
<span class="f1">-		input := wire.NewTxIn(&amp;inputTxOutpoint, inputTx.TxOut[i].Value, nil)</span>
<span class="f2">+</span>		<span class="f2">input := wire.NewTxIn(&amp;inputTxOutpoint, nil, nil)</span>
 
 		pkScript := inputTx.TxOut[i].PkScript
 
<span class="f1">-		p.cj.AddInput(input, pkScript, 0, w.privForPkScript(pkScript))</span>
<span class="f2">+</span>		<span class="f2">p.cj.AddInput(input, inputTx.TxOut[i].Value, pkScript, 0, w.privForPkScript(pkScript))</span>
 	}
 
 	ctx, cancel := context.WithCancel(context.Background())
<span class="bold">diff --git a/mixing/mixclient/coinjoin.go b/mixing/mixclient/coinjoin.go</span>
<span class="bold">index 379a7980..f5e22a9c 100644</span>
<span class="bold">--- a/mixing/mixclient/coinjoin.go</span>
<span class="bold">+++ b/mixing/mixclient/coinjoin.go</span>
<span class="f6">@@ -8,12 +8,12 @@</span> import (
 	&quot;crypto/subtle&quot;
 	&quot;errors&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/dcrec/secp256k1/v4&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/dcrutil/v4/txsort&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/btcec/v2&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/btcutil/txsort&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/txscript&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 	&quot;github.com/decred/dcrd/mixing/utxoproof&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/txscript/v4&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
 )
 
 // msize is the message size of a mixed message (hash160).
<span class="f6">@@ -37,7 +37,7 @@</span> type identity = [33]byte
 // CoinJoin tracks the in-progress coinjoin transaction for a single peer as
 // the mixing protocol is performed.
 type CoinJoin struct {
<span class="f1">-	txHash chainhash.Hash</span>
<span class="f2">+</span>	<span class="f2">initialTxHash chainhash.Hash</span>
 
 	genFunc GenFunc
 
<span class="f6">@@ -66,7 +66,7 @@</span> type GenFunc func(count uint32) (wire.MixVect, error)
 func NewCoinJoin(gen GenFunc, change *wire.TxOut, mixValue int64, prExpiry uint32, mcount uint32) *CoinJoin {
 	return &amp;CoinJoin{
 		genFunc:     gen,
<span class="f1">-		tx:          wire.NewMsgTx(),</span>
<span class="f2">+</span>		<span class="f2">tx:          wire.NewMsgTx(wire.TxVersion),</span>
 		change:      change,
 		peerPRs:     make(map[identity]*wire.MsgMixPairReq),
 		contributed: make(map[wire.OutPoint]identity),
<span class="f6">@@ -83,8 +83,8 @@</span> func NewCoinJoin(gen GenFunc, change *wire.TxOut, mixValue int64, prExpiry uint3
 // that this wallet is able to spend the UTXO.  The private key is not
 // retained by the CoinJoin structure and may be zerod from memory after
 // AddInput returns.
<span class="f1">-func (c *CoinJoin) AddInput(input *wire.TxIn, prevScript []byte, prevScriptVersion uint16,</span>
<span class="f1">-	privKey *secp256k1.PrivateKey) error {</span>
<span class="f2">+func (c *CoinJoin) AddInput(input *wire.TxIn, value int64, prevScript []byte, prevScriptVersion uint16,</span>
<span class="f2">+</span>	<span class="f2">privKey *btcec.PrivateKey) error {</span>
 
 	pub := privKey.PubKey().SerializeCompressed()
 	keyPair := utxoproof.Secp256k1KeyPair{
<span class="f6">@@ -97,10 +97,10 @@</span> func (c *CoinJoin) AddInput(input *wire.TxIn, prevScript []byte, prevScriptVersi
 	}
 
 	var opcode byte
<span class="f1">-	switch prevScript[0] {</span>
<span class="f1">-	case txscript.OP_SSGEN, txscript.OP_SSRTX, txscript.OP_TGEN:</span>
<span class="f1">-		opcode = prevScript[0]</span>
<span class="f1">-	}</span>
<span class="f2">+</span>	<span class="f2">// switch prevScript[0] {</span>
<span class="f2">+</span>	<span class="f2">// case txscript.OP_SSGEN, txscript.OP_SSRTX, txscript.OP_TGEN:</span>
<span class="f2">+</span>	<span class="f2">// 	opcode = prevScript[0]</span>
<span class="f2">+</span>	<span class="f2">// }</span>
 
 	c.prUTXOs = append(c.prUTXOs, wire.MixPairReqUTXO{
 		OutPoint:  input.PreviousOutPoint,
<span class="f6">@@ -111,7 +111,7 @@</span> func (c *CoinJoin) AddInput(input *wire.TxIn, prevScript []byte, prevScriptVersi
 	})
 
 	c.prevScripts[input.PreviousOutPoint] = prevScript
<span class="f1">-	c.inputValue += input.ValueIn</span>
<span class="f2">+</span>	<span class="f2">c.inputValue += value</span>
 
 	return nil
 }
<span class="f6">@@ -134,7 +134,7 @@</span> func (c *CoinJoin) resetUnmixed(prs []*wire.MsgMixPairReq) {
 		c.peerPRs[pr.Identity] = pr
 		for i := range pr.UTXOs {
 			prevOutPoint := &amp;pr.UTXOs[i].OutPoint
<span class="f1">-			in := wire.NewTxIn(prevOutPoint, wire.NullValueIn, nil)</span>
<span class="f2">+</span>			<span class="f2">in := wire.NewTxIn(prevOutPoint, nil, nil)</span>
 			c.tx.AddTxIn(in)
 			c.contributed[*prevOutPoint] = pr.Identity
 		}
<span class="f6">@@ -203,22 +203,25 @@</span> func (c *CoinJoin) sort() {
 		}
 	}
 
<span class="f1">-	c.txHash = c.tx.TxHash()</span>
<span class="f2">+</span>	<span class="f2">// The tx hash changes for each input signature added to the tx. The correct</span>
<span class="f2">+</span>	<span class="f2">// hash for the final coinjoin is the tx hash gotten after all inputs are</span>
<span class="f2">+</span>	<span class="f2">// signed.</span>
<span class="f2">+</span>	<span class="f2">c.initialTxHash = c.tx.TxHash()</span>
 }
 
 // constantTimeOutputSearch searches for the output indices of mixed outputs to
 // verify inclusion in a coinjoin.  It is constant time such that, for each
 // searched script, all outputs with equal value, script versions, and script
 // lengths matching the searched output are checked in constant time.
<span class="f1">-func constantTimeOutputSearch(tx *wire.MsgTx, value int64, scriptVer uint16, scripts [][]byte) ([]int, error) {</span>
<span class="f2">+func constantTimeOutputSearch(tx *wire.MsgTx, value int64 /*scriptVer uint16,*/, scripts [][]byte) ([]int, error) {</span>
 	var scan []int
 	for i, out := range tx.TxOut {
 		if out.Value != value {
 			continue
 		}
<span class="f1">-		if out.Version != scriptVer {</span>
<span class="f1">-			continue</span>
<span class="f1">-		}</span>
<span class="f2">+</span>		<span class="f2">// if out.Version != scriptVer {</span>
<span class="f2">+</span>		<span class="f2">// 	continue</span>
<span class="f2">+</span>		<span class="f2">// }</span>
 		if len(out.PkScript) != len(scripts[0]) {
 			continue
 		}
<span class="f6">@@ -246,7 +249,7 @@</span> func constantTimeOutputSearch(tx *wire.MsgTx, value int64, scriptVer uint16, scr
 // signs inputs being contributed by the peer.  returns errMissingGen to
 // trigger blame assignment if a message is not found.
 func (c *CoinJoin) confirm(wallet Wallet) error {
<span class="f1">-	genIndices, err := constantTimeOutputSearch(c.tx, c.mixValue, 0, c.genScripts)</span>
<span class="f2">+</span>	<span class="f2">genIndices, err := constantTimeOutputSearch(c.tx, c.mixValue, c.genScripts)</span>
 	if err != nil {
 		return err
 	}
<span class="f6">@@ -270,7 +273,7 @@</span> func (c *CoinJoin) confirm(wallet Wallet) error {
 // Peers must be removed in the next run if mergeSignatures returns an error.
 func (c *CoinJoin) mergeSignatures(cm *wire.MsgMixConfirm) error {
 	// Signatures may only be used if an identical transaction was signed.
<span class="f1">-	if cm.Mix.TxHash() != c.txHash {</span>
<span class="f2">+</span>	<span class="f2">if txscript.ShallowTxCopyNoSigs(&amp;cm.Mix).TxHash() != c.initialTxHash {</span>
 		return errSignedWrongTx
 	}
 
<span class="bold">diff --git a/mixing/mixclient/limits.go b/mixing/mixclient/limits.go</span>
<span class="bold">index c996eebc..d8e63836 100644</span>
<span class="bold">--- a/mixing/mixclient/limits.go</span>
<span class="bold">+++ b/mixing/mixclient/limits.go</span>
<span class="f6">@@ -7,7 +7,7 @@</span> package mixclient
 import (
 	&quot;errors&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 )
 
 var errExceedsStandardSize = errors.New(&quot;tx size would exceed standardness rules&quot;)
<span class="bold">diff --git a/mixing/mixclient/log_test.go b/mixing/mixclient/log_test.go</span>
<span class="bold">index a674e8fd..e6c8451b 100644</span>
<span class="bold">--- a/mixing/mixclient/log_test.go</span>
<span class="bold">+++ b/mixing/mixclient/log_test.go</span>
<span class="f6">@@ -7,8 +7,8 @@</span> package mixclient
 import (
 	&quot;testing&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/mixing/mixpool&quot;</span>
<span class="f1">-	&quot;github.com/decred/slog&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing/mixpool&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btclog&quot;</span>
 )
 
 type testLog struct {
<span class="f6">@@ -26,12 +26,12 @@</span> func (t *testLog) Write(b []byte) (int, error) {
 //
 // Due to the use of global logger variables that must write to test logs to
 // individual test variables, it is not possible to parallelize tests.
<span class="f1">-func useTestLogger(t *testing.T) (slog.Logger, func()) {</span>
<span class="f1">-	backend := slog.NewBackend(&amp;testLog{T: t})</span>
<span class="f2">+func useTestLogger(t *testing.T) (btclog.Logger, func()) {</span>
<span class="f2">+</span>	<span class="f2">backend := btclog.NewBackend(&amp;testLog{T: t})</span>
 	l := backend.Logger(&quot;TEST&quot;)
<span class="f1">-	l.SetLevel(slog.LevelTrace)</span>
<span class="f2">+</span>	<span class="f2">l.SetLevel(btclog.LevelTrace)</span>
 	mixpool.UseLogger(l)
 	return l, func() {
<span class="f1">-		mixpool.UseLogger(slog.Disabled)</span>
<span class="f2">+</span>		<span class="f2">mixpool.UseLogger(btclog.Disabled)</span>
 	}
 }
<span class="bold">diff --git a/mixing/mixpool/errors.go b/mixing/mixpool/errors.go</span>
<span class="bold">index 6e342f90..027b1f53 100644</span>
<span class="bold">--- a/mixing/mixpool/errors.go</span>
<span class="bold">+++ b/mixing/mixpool/errors.go</span>
<span class="f6">@@ -7,8 +7,8 @@</span> package mixpool
 import (
 	&quot;errors&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 )
 
 // RuleError represents a mixpool rule violation.
<span class="bold">diff --git a/mixing/mixpool/log.go b/mixing/mixpool/log.go</span>
<span class="bold">index 9f2ee50f..ccdd7b91 100644</span>
<span class="bold">--- a/mixing/mixpool/log.go</span>
<span class="bold">+++ b/mixing/mixpool/log.go</span>
<span class="f6">@@ -5,19 +5,19 @@</span>
 package mixpool
 
 import (
<span class="f1">-	&quot;github.com/decred/slog&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btclog&quot;</span>
 )
 
 // log is a logger that is initialized with no output filters.  This
 // means the package will not perform any logging by default until the caller
 // requests it.
 // The default amount of logging is none.
<span class="f1">-var log = slog.Disabled</span>
<span class="f2">+var log = btclog.Disabled</span>
 
 // UseLogger uses a specified Logger to output package logging info.
 // This should be used in preference to SetLogWriter if the caller is also
<span class="f1">-// using slog.</span>
<span class="f1">-func UseLogger(logger slog.Logger) {</span>
<span class="f2">+// using btclog.</span>
<span class="f2">+func UseLogger(logger btclog.Logger) {</span>
 	log = logger
 }
 
<span class="bold">diff --git a/mixing/mixpool/mixpool.go b/mixing/mixpool/mixpool.go</span>
<span class="bold">index 5c163769..7b11252e 100644</span>
<span class="bold">--- a/mixing/mixpool/mixpool.go</span>
<span class="bold">+++ b/mixing/mixpool/mixpool.go</span>
<span class="f6">@@ -14,16 +14,15 @@</span> import (
 	&quot;sync&quot;
 	&quot;time&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/v3&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/btcutil&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/txscript&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btclog&quot;</span>
 	&quot;github.com/decred/dcrd/container/lru&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/mixing&quot;</span>
 	&quot;github.com/decred/dcrd/mixing/utxoproof&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/txscript/v4&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/txscript/v4/stdaddr&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/txscript/v4/stdscript&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
<span class="f1">-	&quot;github.com/decred/slog&quot;</span>
 )
 
 const minconf = 1
<span class="f6">@@ -891,7 +890,7 @@</span> func (p *Pool) AcceptMessage(msg mixing.Message) (accepted []mixing.Message, err
 			// Don't log duplicate messages or non-KE orphans.
 			return
 		}
<span class="f1">-		if log.Level() &gt; slog.LevelDebug {</span>
<span class="f2">+</span>		<span class="f2">if log.Level() &gt; btclog.LevelDebug {</span>
 			return
 		}
 		if err != nil {
<span class="f6">@@ -1122,8 +1121,8 @@</span> func (p *Pool) checkAcceptPR(pr *wire.MsgMixPairReq) error {
 		if isDustAmount(pr.Change.Value, p2pkhv0PkScriptSize, feeRate) {
 			return ruleError(ErrChangeDust)
 		}
<span class="f1">-		if !stdscript.IsPubKeyHashScriptV0(pr.Change.PkScript) &amp;&amp;</span>
<span class="f1">-			!stdscript.IsScriptHashScriptV0(pr.Change.PkScript) {</span>
<span class="f2">+</span>		<span class="f2">if !txscript.IsPayToPubKeyHash(pr.Change.PkScript) &amp;&amp;</span>
<span class="f2">+</span>			<span class="f2">!txscript.IsPayToScriptHash(pr.Change.PkScript) {</span>
 			return ruleError(ErrInvalidScript)
 		}
 	}
<span class="f6">@@ -1345,13 +1344,14 @@</span> func (p *Pool) checkUTXOs(pr *wire.MsgMixPairReq, curHeight int64) error {
 		var extractPubKeyHash160 func([]byte) []byte
 		switch {
 		case utxo.Opcode == 0:
<span class="f1">-			extractPubKeyHash160 = stdscript.ExtractPubKeyHashV0</span>
<span class="f1">-		case utxo.Opcode == txscript.OP_SSGEN:</span>
<span class="f1">-			extractPubKeyHash160 = stdscript.ExtractStakeGenPubKeyHashV0</span>
<span class="f1">-		case utxo.Opcode == txscript.OP_SSRTX:</span>
<span class="f1">-			extractPubKeyHash160 = stdscript.ExtractStakeRevocationPubKeyHashV0</span>
<span class="f1">-		case utxo.Opcode == txscript.OP_TGEN:</span>
<span class="f1">-			extractPubKeyHash160 = stdscript.ExtractTreasuryGenPubKeyHashV0</span>
<span class="f2">+</span>			<span class="f2">extractPubKeyHash160 = txscript.ExtractPubKeyHash</span>
<span class="f2">+</span>		<span class="f2">// TODO!: Consider removing utxo.Opcode, doesn't seem relevant for btc.</span>
<span class="f2">+</span>		<span class="f2">// case utxo.Opcode == txscript.OP_SSGEN:</span>
<span class="f2">+</span>		<span class="f2">// 	extractPubKeyHash160 = stdscript.ExtractStakeGenPubKeyHashV0</span>
<span class="f2">+</span>		<span class="f2">// case utxo.Opcode == txscript.OP_SSRTX:</span>
<span class="f2">+</span>		<span class="f2">// 	extractPubKeyHash160 = stdscript.ExtractStakeRevocationPubKeyHashV0</span>
<span class="f2">+</span>		<span class="f2">// case utxo.Opcode == txscript.OP_TGEN:</span>
<span class="f2">+</span>		<span class="f2">// 	extractPubKeyHash160 = stdscript.ExtractTreasuryGenPubKeyHashV0</span>
 		default:
 			return ruleError(fmt.Errorf(&quot;unsupported output script for UTXO %s&quot;, &amp;utxo.OutPoint))
 		}
<span class="f6">@@ -1374,7 +1374,7 @@</span> func (p *Pool) checkUTXOs(pr *wire.MsgMixPairReq, curHeight int64) error {
 
 func validateOwnerProofP2PKHv0(extractFunc func([]byte) []byte, pkscript, pubkey, sig []byte, expires uint32) bool {
 	extractedHash160 := extractFunc(pkscript)
<span class="f1">-	pubkeyHash160 := stdaddr.Hash160(pubkey)</span>
<span class="f2">+</span>	<span class="f2">pubkeyHash160 := btcutil.Hash160(pubkey)</span>
 	if !bytes.Equal(extractedHash160, pubkeyHash160) {
 		return false
 	}
<span class="bold">diff --git a/mixing/mixpool/mixpool_test.go b/mixing/mixpool/mixpool_test.go</span>
<span class="bold">index bdfb5a81..cda001e3 100644</span>
<span class="bold">--- a/mixing/mixpool/mixpool_test.go</span>
<span class="bold">+++ b/mixing/mixpool/mixpool_test.go</span>
<span class="f6">@@ -17,20 +17,20 @@</span> import (
 	&quot;time&quot;
 
 	&quot;decred.org/cspp/v2/solverrpc&quot;
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/btcutil&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing/internal/chacha20prng&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/txscript&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 	&quot;github.com/davecgh/go-spew/spew&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/v3&quot;</span>
 	&quot;github.com/decred/dcrd/crypto/blake256&quot;
 	&quot;github.com/decred/dcrd/dcrec/secp256k1/v4&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/mixing&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/mixing/internal/chacha20prng&quot;</span>
 	&quot;github.com/decred/dcrd/mixing/utxoproof&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/txscript/v4&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/txscript/v4/stdaddr&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
 )
 
<span class="f1">-var params = chaincfg.SimNetParams()</span>
<span class="f2">+var params = chaincfg.SimNetParams</span>
 
 var seed [32]byte
 
<span class="f6">@@ -104,7 +104,7 @@</span> func (m *mockUTXO) BlockHeight() int64    { return m.blockHeight }
 func (m *mockUTXO) Amount() int64         { return m.output.Value }
 
 func makeMockUTXO(rand io.Reader, value int64) *mockUTXO {
<span class="f1">-	tx := wire.NewMsgTx()</span>
<span class="f2">+</span>	<span class="f2">tx := wire.NewMsgTx(wire.TxVersion)</span>
 
 	pub, priv, err := generateSecp256k1(rand)
 	if err != nil {
<span class="f6">@@ -119,7 +119,7 @@</span> func makeMockUTXO(rand io.Reader, value int64) *mockUTXO {
 		23: txscript.OP_EQUALVERIFY,
 		24: txscript.OP_CHECKSIG,
 	}
<span class="f1">-	hash160 := stdaddr.Hash160(pubSerialized)</span>
<span class="f2">+</span>	<span class="f2">hash160 := btcutil.Hash160(pubSerialized)</span>
 	copy(p2pkhScript[3:23], hash160)
 
 	output := wire.NewTxOut(value, p2pkhScript)
<span class="f6">@@ -129,7 +129,7 @@</span> func makeMockUTXO(rand io.Reader, value int64) *mockUTXO {
 		outpoint: wire.OutPoint{
 			Hash:  tx.TxHash(),
 			Index: 0,
<span class="f1">-			Tree:  0,</span>
<span class="f2">+</span>			<span class="f2">// Tree:  0,</span>
 		},
 		tx:      tx,
 		output:  output,
<span class="f6">@@ -167,7 +167,7 @@</span> type fakechain struct {
 }
 
 func (c *fakechain) ChainParams() *chaincfg.Params {
<span class="f1">-	return params</span>
<span class="f2">+</span>	<span class="f2">return &amp;params</span>
 }
 
 func (c *fakechain) CurrentTip() (chainhash.Hash, int64) {
<span class="f6">@@ -199,10 +199,10 @@</span> func TestAccept(t *testing.T) {
 	h := blake256.New()
 
 	var (
<span class="f1">-		expires      uint32 = 1010</span>
<span class="f2">+</span>		<span class="f2">expires      uint32 = uint32(c.height) + 2</span>
 		mixAmount    int64  = 10e8
 		scriptClass         = mixing.ScriptClassP2PKHv0
<span class="f1">-		txVersion    uint16 = wire.TxVersion</span>
<span class="f2">+</span>		<span class="f2">txVersion    int32  = wire.TxVersion</span>
 		lockTime     uint32 = 0
 		messageCount uint32 = 1
 		inputValue   int64  = 20e8
<span class="f6">@@ -377,7 +377,7 @@</span> func TestAccept(t *testing.T) {
 	res := mixing.XorVectors(dcVecs)
 	t.Logf(&quot;recovered message set %v&quot;, res.String())
 
<span class="f1">-	tx := wire.NewMsgTx()</span>
<span class="f2">+</span>	<span class="f2">tx := wire.NewMsgTx(wire.TxVersion)</span>
 	for i := range res {
 		hash160 := res[i][:]
 		pkscript := []byte{
<span class="bold">diff --git a/mixing/mixpool/orphans_test.go b/mixing/mixpool/orphans_test.go</span>
<span class="bold">index 48ffd791..79c075ef 100644</span>
<span class="bold">--- a/mixing/mixpool/orphans_test.go</span>
<span class="bold">+++ b/mixing/mixpool/orphans_test.go</span>
<span class="f6">@@ -10,11 +10,11 @@</span> import (
 	&quot;testing&quot;
 	&quot;time&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/v3&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 	&quot;github.com/decred/dcrd/crypto/blake256&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/mixing&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
 )
 
 var (
<span class="f6">@@ -22,7 +22,7 @@</span> var (
 	testStartingBlock         = chainhash.Hash{100}
 )
 
<span class="f1">-var testnetParams = chaincfg.TestNet3Params()</span>
<span class="f2">+var testnetParams = chaincfg.TestNet3Params</span>
 
 type testBlockchain struct{}
 
<span class="f6">@@ -35,7 +35,7 @@</span> func (b *testBlockchain) CurrentTip() (chainhash.Hash, int64) {
 }
 
 func (b *testBlockchain) ChainParams() *chaincfg.Params {
<span class="f1">-	return testnetParams</span>
<span class="f2">+</span>	<span class="f2">return &amp;testnetParams</span>
 }
 
 // Intentionally create orphans and test their acceptance behavior when PRs
<span class="f6">@@ -55,7 +55,7 @@</span> func TestOrphans(t *testing.T) {
 			{},
 		},
 		MessageCount: 1,
<span class="f1">-		Expiry:       testStartingHeight + 10,</span>
<span class="f2">+</span>		<span class="f2">Expiry:       testStartingHeight + 2,</span>
 		ScriptClass:  string(mixing.ScriptClassP2PKHv0),
 		InputValue:   1 &lt;&lt; 18,
 	}
<span class="bold">diff --git a/mixing/sid.go b/mixing/sid.go</span>
<span class="bold">index 7394bf60..2aab7bfe 100644</span>
<span class="bold">--- a/mixing/sid.go</span>
<span class="bold">+++ b/mixing/sid.go</span>
<span class="f6">@@ -9,9 +9,9 @@</span> import (
 	&quot;encoding/binary&quot;
 	&quot;sort&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 	&quot;github.com/decred/dcrd/crypto/blake256&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
 )
 
 // deriveSessionID creates the mix session identifier from an initial sorted
<span class="bold">diff --git a/mixing/sid_test.go b/mixing/sid_test.go</span>
<span class="bold">index 8225cb06..4bda9698 100644</span>
<span class="bold">--- a/mixing/sid_test.go</span>
<span class="bold">+++ b/mixing/sid_test.go</span>
<span class="f6">@@ -11,8 +11,8 @@</span> import (
 	&quot;sort&quot;
 	&quot;testing&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/chaincfg/chainhash&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/chaincfg/chainhash&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 )
 
 func TestSessionID(t *testing.T) {
<span class="bold">diff --git a/mixing/signatures.go b/mixing/signatures.go</span>
<span class="bold">index 190a06c2..6b51228c 100644</span>
<span class="bold">--- a/mixing/signatures.go</span>
<span class="bold">+++ b/mixing/signatures.go</span>
<span class="f6">@@ -9,10 +9,10 @@</span> import (
 	&quot;fmt&quot;
 	&quot;hash&quot;
 
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/wire&quot;</span>
 	&quot;github.com/decred/dcrd/crypto/blake256&quot;
 	&quot;github.com/decred/dcrd/dcrec/secp256k1/v4&quot;
 	&quot;github.com/decred/dcrd/dcrec/secp256k1/v4/schnorr&quot;
<span class="f1">-	&quot;github.com/decred/dcrd/wire&quot;</span>
 )
 
 const tag = &quot;decred-mix-signature&quot;
<span class="bold">diff --git a/mixing/utxoproof/utxoproof.go b/mixing/utxoproof/utxoproof.go</span>
<span class="bold">deleted file mode 100644</span>
<span class="bold">index e0a33ec3..00000000</span>
<span class="bold">--- a/mixing/utxoproof/utxoproof.go</span>
<span class="bold">+++ /dev/null</span>
<span class="f6">@@ -1,90 +0,0 @@</span>
<span class="f1">-// Copyright (c) 2023 The Decred developers</span>
<span class="f1">-// Use of this source code is governed by an ISC</span>
<span class="f1">-// license that can be found in the LICENSE file.</span>
<span class="f1">-</span>
<span class="f1">-package utxoproof</span>
<span class="f1">-</span>
<span class="f1">-import (</span>
<span class="f1">-	&quot;encoding/binary&quot;</span>
<span class="f1">-</span>
<span class="f1">-	&quot;github.com/decred/dcrd/crypto/blake256&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/dcrec/secp256k1/v4&quot;</span>
<span class="f1">-	&quot;github.com/decred/dcrd/dcrec/secp256k1/v4/schnorr&quot;</span>
<span class="f1">-)</span>
<span class="f1">-</span>
<span class="f1">-// Tags and schemes describing the message being signed.</span>
<span class="f1">-//</span>
<span class="f1">-// These strings must not contain the comma, which is reserved as a separator</span>
<span class="f1">-// character.</span>
<span class="f1">-const (</span>
<span class="f1">-	tag = &quot;mixpr-utxoproof&quot;</span>
<span class="f1">-</span>
<span class="f1">-	// schemes</span>
<span class="f1">-	secp256k1P2PKH = &quot;P2PKH(EC-Schnorr-DCRv0)&quot;</span>
<span class="f1">-)</span>
<span class="f1">-</span>
<span class="f1">-var sep = []byte{','}</span>
<span class="f1">-</span>
<span class="f1">-// The signature hash is created from the serialization of:</span>
<span class="f1">-//   tag , scheme , expiry pubkey</span>
<span class="f1">-// No separator is written after expiry; it is fixed length.</span>
<span class="f1">-</span>
<span class="f1">-// Secp256k1KeyPair provides access to the serialized public key and parsed</span>
<span class="f1">-// private key of a secp256k1 key pair.</span>
<span class="f1">-type Secp256k1KeyPair struct {</span>
<span class="f1">-	Pub  []byte</span>
<span class="f1">-	Priv *secp256k1.PrivateKey</span>
<span class="f1">-}</span>
<span class="f1">-</span>
<span class="f1">-// SignUtxoProof returns the UTXO proof of ownership over an output controlled</span>
<span class="f1">-// by the keypair.  The UTXO proof is only valid for the provided expiry</span>
<span class="f1">-// height to prevent its inclusion in other PR messages signed by an unrelated</span>
<span class="f1">-// identity.</span>
<span class="f1">-func (k *Secp256k1KeyPair) SignUtxoProof(expires uint32) ([]byte, error) {</span>
<span class="f1">-	const scheme = secp256k1P2PKH</span>
<span class="f1">-</span>
<span class="f1">-	h := blake256.New()</span>
<span class="f1">-	h.Write([]byte(tag))</span>
<span class="f1">-	h.Write(sep)</span>
<span class="f1">-	h.Write([]byte(scheme))</span>
<span class="f1">-	h.Write(sep)</span>
<span class="f1">-	expiresBytes := binary.BigEndian.AppendUint32(make([]byte, 0, 4), expires)</span>
<span class="f1">-	h.Write(expiresBytes)</span>
<span class="f1">-	h.Write(k.Pub)</span>
<span class="f1">-	hash := h.Sum(nil)</span>
<span class="f1">-</span>
<span class="f1">-	sig, err := schnorr.Sign(k.Priv, hash)</span>
<span class="f1">-	if err != nil {</span>
<span class="f1">-		return nil, err</span>
<span class="f1">-	}</span>
<span class="f1">-</span>
<span class="f1">-	return sig.Serialize(), nil</span>
<span class="f1">-}</span>
<span class="f1">-</span>
<span class="f1">-// ValidateSecp256k1P2PKH validates the UTXO proof of an output controlled by</span>
<span class="f1">-// a secp256k1 keypair for the given expiry height.  Returns true only if the</span>
<span class="f1">-// proof is valid.</span>
<span class="f1">-func ValidateSecp256k1P2PKH(pubkey, proof []byte, expires uint32) bool {</span>
<span class="f1">-	const scheme = secp256k1P2PKH</span>
<span class="f1">-</span>
<span class="f1">-	pubkeyParsed, err := secp256k1.ParsePubKey(pubkey)</span>
<span class="f1">-	if err != nil {</span>
<span class="f1">-		return false</span>
<span class="f1">-	}</span>
<span class="f1">-	proofParsed, err := schnorr.ParseSignature(proof)</span>
<span class="f1">-	if err != nil {</span>
<span class="f1">-		return false</span>
<span class="f1">-	}</span>
<span class="f1">-</span>
<span class="f1">-	h := blake256.New()</span>
<span class="f1">-	h.Write([]byte(tag))</span>
<span class="f1">-	h.Write(sep)</span>
<span class="f1">-	h.Write([]byte(scheme))</span>
<span class="f1">-	h.Write(sep)</span>
<span class="f1">-	expiresBytes := binary.BigEndian.AppendUint32(make([]byte, 0, 4), expires)</span>
<span class="f1">-	h.Write(expiresBytes)</span>
<span class="f1">-	h.Write(pubkey)</span>
<span class="f1">-	hash := h.Sum(nil)</span>
<span class="f1">-</span>
<span class="f1">-	return proofParsed.Verify(hash, pubkeyParsed)</span>
<span class="f1">-}</span>
<span class="bold">diff --git a/mixing/vec.go b/mixing/vec.go</span>
<span class="bold">index 2293057a..acf79a9e 100644</span>
<span class="bold">--- a/mixing/vec.go</span>
<span class="bold">+++ b/mixing/vec.go</span>
<span class="f6">@@ -8,7 +8,7 @@</span> import (
 	&quot;fmt&quot;
 	&quot;strings&quot;
 
<span class="f1">-	&quot;github.com/decred/dcrd/mixing/internal/chacha20prng&quot;</span>
<span class="f2">+</span>	<span class="f2">&quot;github.com/btcsuite/btcd/mixing/internal/chacha20prng&quot;</span>
 )
 
 // Msize is the size of the message being mixed.  This is the size of a
</pre>
</body>
</html>
